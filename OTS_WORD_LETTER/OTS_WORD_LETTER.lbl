<?xml version="1.0" encoding="UTF-8"?>
<OTS>
	<OTS_Type>C# Component</OTS_Type>
	<Description>This&#x20;component&#x20;provides&#x20;a&#x20;way&#x20;to&#x20;automatically&#x20;generate&#x20;word&#x20;letter/reports&#x20;in&#x20;Microsoft&#x20;Word&#x20;format.&#xD;&#xA;It&#x20;does&#x20;so&#x20;by&#x20;copying&#x20;a&#x20;Microsoft&#x20;Word&#x20;document&#x20;template&#x20;and&#x20;then&#x20;replacing&#x20;all&#x20;data&#x20;fields&#x20;in&#x20;that&#x20;copy&#x20;by&#x20;content&#x20;from&#x20;data&#x20;passed&#x20;to&#x20;this&#x20;component.&#xD;&#xA;The&#x20;expected&#x20;&#x20;template&#x20;format&#x20;is&#x20;the&#x20;Microsoft&#x20;docx&#x20;format.&#xD;&#xA;A&#x20;Microsoft&#x20;Word&#x20;installation&#x20;is&#x20;NOT&#x20;needed&#x20;on&#x20;the&#x20;computer&#x20;where&#x20;this&#x20;component&#x20;is&#x20;run,&#x20;as&#x20;the&#x20;component&#x20;uses&#x20;the&#x20;Office&#x20;Open&#x20;XML&#x20;file&#x20;format&#x20;for&#x20;generating&#x20;a&#x20;result&#x20;document.&#xD;&#xA;&#xD;&#xA;The&#x20;Microsoft&#x20;Word&#x20;document&#x20;template&#x20;must&#x20;contain&#x20;placeholders,&#x20;so&#x20;called&#x20;Controls,&#x20;where&#x20;&#x20;information&#x20;from&#x20;the&#x20;data&#x20;model&#x20;will&#x20;be&#x20;represented&#x20;in&#x20;the&#x20;final&#x20;result&#x20;document.&#xD;&#xA;How&#x20;to&#x20;create&#x20;such&#x20;a&#x20;document&#x20;is&#x20;described&#x20;below.&#x20;A&#x20;sample&#x20;Microsoft&#x20;Word&#x20;template&#x20;is&#x20;also&#x20;available&#x20;and&#x20;used&#x20;in&#x20;the&#x20;given&#x20;examples.&#xD;&#xA;&#xD;&#xA;The&#x20;component&#x20;offers&#x20;two&#x20;methods:&#xD;&#xA;&#x9;-1-&#x20;A&#x20;method&#x20;ControlInfo(templatefilepath)&#x20;&#x20;that&#x20;will&#x20;show&#x20;the&#x20;available&#x20;Controls&#x20;in&#x20;the&#x20;template.&#xD;&#xA;&#x9;&#x9;This&#x20;serves&#x20;to&#x20;do&#x20;a&#x20;sanity&#x20;check:&#x20;are&#x20;the&#x20;Controls&#x20;you&#x20;want&#x20;to&#x20;fill&#x20;present&#x20;in&#x20;the&#x20;template?&#xD;&#xA;&#x9;&#x9;In&#x20;the&#x20;Application/SqlCommand&#x20;window&#x20;you&#x20;can&#x20;try&#x20;this&#x20;on&#x20;the&#x20;sample&#x20;template,&#x20;execute:&#xD;&#xA;&#x9;&#x9;&#x9;select&#x20;OTS_WORD_LETTER.ControlInfo(&#x20;&#x20;RulesEngine.Getproperty(&apos;TEMPDIR&apos;)&#x20;||&#x20;&apos;.OffTheShelfs\OTS_WORD_LETTER\OTS_Sample_WordReport.docx&apos;&#x20;&#x20;);&#xD;&#xA;&#x9;&#x9;The&#x20;thought&#x20;behind&#x20;this&#x20;method&#x20;can&#x20;be&#x20;developed&#x20;further&#x20;&#x20;to&#x20;automatically&#x20;categorize&#x20;and&#x20;maintain&#x20;the&#x20;set&#x20;of&#x20;templates&#x20;in&#x20;an&#x20;organization.&#xD;&#xA;&#x9;-2-&#x20;A&#x20;method&#x20;Run(templatefilepath,&#x20;resultfilepath,&#x20;[parameters,&#x20;...])&#x20;that&#x20;will&#x20;produce&#x20;the&#x20;result&#x20;document&#x20;from&#x20;the&#x20;template&#x20;and&#x20;data&#x20;passed.&#xD;&#xA;&#x9;&#x9;In&#x20;the&#x20;application/SqlCommand&#x20;window&#x20;you&#x20;can&#x20;try:&#xD;&#xA;&#x9;&#x9;&#x9;invoke&#x20;OTS_WORD_LETTER.RUN&#x20;with&#x20;select&#x20;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;RulesEngine.Getproperty(&apos;TEMPDIR&apos;)&#x20;||&#x20;&apos;.OffTheShelfs\OTS_WORD_LETTER\OTS_Sample_WordReport.docx&apos;,&#x20;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;RulesEngine.Getproperty(&apos;TEMPDIR&apos;)&#x20;||&#x20;&apos;Result.docx&apos;,&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;RulesEngine.Getproperty(&apos;TEMPDIR&apos;)&#x20;||&#x20;&apos;.OffTheShelfs\OTS_WORD_LETTER\OTS_Sample_Xml.xml&apos;&#xD;&#xA;&#x9;&#x9;The&#x20;Run&#x20;method&#x20;produces&#x20;the&#x20;location&#x20;of&#x20;the&#x20;result&#x20;document&#x20;that&#x20;can&#x20;be&#x20;opened&#x20;with&#x20;Microsoft&#x20;Word&#x20;to&#x20;see&#x20;the&#x20;result&#x20;document.&#xD;&#xA;&#x9;&#x9;This&#x20;example&#x20;fills&#x20;data&#x20;from&#x20;an&#x20;xml&#x20;document&#x20;into&#x20;the&#x20;copy&#x20;of&#x20;the&#x20;template&#x20;document.&#xD;&#xA;&#xD;&#xA;The&#x20;Run&#x20;method&#x20;has&#x20;a&#x20;number&#x20;of&#x20;ways&#x20;to&#x20;pass&#x20;data&#x20;for&#x20;the&#x20;Controls.&#x20;&#xD;&#xA;&#x9;-a-&#x20;Passing&#x20;a&#x20;single&#x20;filepath&#x20;argument&#x20;with&#x20;a&#x20;propriety&#x20;xml&#x20;format&#x20;that&#x20;contains&#x20;the&#x20;data.&#x20;Inspect&#x20;the&#x20;example&#x20;above.&#x20;It&#x20;contains&#x20;plain&#x20;values&#x20;and&#x20;a&#x20;table.&#xD;&#xA;&#x9;-b-&#x20;Passing&#x20;name&#x20;-&#x20;value&#x20;pairs&#x20;as&#x20;data&#x20;for&#x20;Controls.&#x20;&#xD;&#xA;&#x9;&#x9;Try&#x20;for&#x20;example:&#xD;&#xA;&#x9;&#x9;&#x9;invoke&#x20;OTS_WORD_LETTER.RUN&#x20;with&#x20;select&#x20;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;RulesEngine.Getproperty(&apos;TEMPDIR&apos;)&#x20;||&#x20;&apos;.OffTheShelfs\OTS_WORD_LETTER\OTS_Sample_WordReport.docx&apos;,&#x20;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;RulesEngine.Getproperty(&apos;TEMPDIR&apos;)&#x20;||&#x20;&apos;Result.docx&apos;,&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&apos;PAS_NUMBER&apos;,&#x20;&apos;AX123&apos;,&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&apos;NAME&apos;,&#x20;user&#xD;&#xA;&#x9;&#x9;In&#x20;this&#x20;example,&#x20;the&#x20;result&#x20;document&#x20;has&#x20;PAS_NUMBER&#x20;and&#x20;NAME&#x20;resolved&#x20;but&#x20;the&#x20;other&#x20;Controls&#x20;are&#x20;not&#x20;filled.&#xD;&#xA;&#x9;-c-&#x20;Passing&#x20;name&#x20;-&#x20;xml&#x20;pairs&#x20;as&#x20;data&#x20;&#x20;for&#x20;Controls.&#x20;This&#x20;allows&#x20;filling&#x20;in&#x20;table&#x20;Controls.&#xD;&#xA;&#x9;&#x9;Try&#x20;for&#x20;example:&#xD;&#xA;&#x9;&#x9;&#x9;invoke&#x20;OTS_WORD_LETTER.RUN&#x20;with&#x20;select&#x20;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;RulesEngine.Getproperty(&apos;TEMPDIR&apos;)&#x20;||&#x20;&apos;.OffTheShelfs\OTS_WORD_LETTER\OTS_Sample_WordReport.docx&apos;,&#x20;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;RulesEngine.Getproperty(&apos;TEMPDIR&apos;)&#x20;||&#x20;&apos;Result.docx&apos;,&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&apos;PAS_NUMBER&apos;,&#x20;&apos;AX123&apos;,&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&apos;NAME&apos;,&#x20;user,&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&apos;BOOK_TABLE&apos;,&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&apos;&lt;Books&gt;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;Book&#x20;NAME=&quot;My&#x20;life&#x20;as&#x20;a&#x20;developer&quot;&#x20;AUTHOR=&quot;Dilbert&quot;&#x20;DUE_DATE=&quot;01-JAN-2020&quot;&gt;&lt;/Book&gt;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;Book&#x20;NAME=&quot;Why&#x20;Nations&#x20;Fail&quot;&#x20;AUTHOR=&quot;James&#x20;A.&#x20;Robinson&#x20;&quot;&#x20;DUE_DATE=&quot;17-FEB-2020&quot;&gt;&lt;/Book&gt;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/Books&gt;&apos;&#xD;&#xA;&#x9;&#x9;Now&#x20;also&#x20;the&#x20;books&#x20;on&#x20;loan&#x20;table&#x20;has&#x20;data&#x20;in&#x20;the&#x20;result.&#xD;&#xA;&#x9;&#x9;Note&#x20;that&#x20;you&#x20;could&#x20;have&#x20;used&#x20;data&#x20;from&#x20;your&#x20;data&#x20;model&#x20;in&#x20;the&#x20;call&#x20;by&#x20;taking&#x20;column&#x20;values&#x20;for&#x20;the&#x20;plain&#x20;values&#x20;and&#x20;xml.[sql]export&#x20;result&#x20;for&#x20;the&#x20;Controls&#x20;that&#x20;show&#x20;table&#x20;data.&#xD;&#xA;&#xD;&#xA;Before&#x20;showing&#x20;some&#x20;examples&#x20;that&#x20;use&#x20;data&#x20;from&#x20;your&#x20;data&#x20;model,&#x20;first&#x20;a&#x20;few&#x20;words&#x20;on&#x20;how&#x20;to&#x20;create&#x20;a&#x20;template&#x20;document&#x20;with&#x20;Controls.&#xD;&#xA;&#xD;&#xA;A&#x20;template&#x20;document&#x20;can&#x20;be&#x20;any&#x20;Word&#x20;document&#x20;stored&#x20;in&#x20;docx&#x20;format.&#x20;You&#x20;will&#x20;have&#x20;to&#x20;add&#x20;Controls&#x20;to&#x20;that&#x20;document&#x20;that&#x20;will&#x20;act&#x20;as&#x20;placeholders&#x20;for&#x20;the&#x20;data.&#xD;&#xA;&#x9;-1-&#x20;Create&#x20;a&#x20;word&#x20;template&#x20;document&#x20;that&#x20;contains&#x20;the&#x20;desired&#x20;layout,&#x20;fixed&#x20;text,&#x20;images&#x20;etc.&#xD;&#xA;&#x9;-2-&#x20;If&#x20;the&#x20;menu&#x20;bar&#x20;in&#x20;Microsoft&#x20;Word&#x20;does&#x20;NOT&#x20;show&#x20;a&#x20;&quot;Developer&quot;&#x20;menu,&#x20;you&#x20;will&#x20;have&#x20;to&#x20;activate&#x20;the&#x20;Developer&#x20;menu&#x20;first.&#xD;&#xA;&#x9;&#x9;Depending&#x20;on&#x20;the&#x20;version&#x20;of&#x20;Microsoft&#x20;Word&#x20;you&#x20;would&#x20;activate&#x20;this&#x20;by&#x20;opening&#x20;the&#x20;File&#x20;menu,&#x20;Options.&#x20;Then&#x20;click&#x20;&quot;Customize&#x20;Ribbon&quot;.&#x20;&#xD;&#xA;&#x9;&#x9;Choose&#x20;&quot;Main&#x20;Tabs&quot;&#x20;from&#x20;the&#x20;&quot;Customize&#x20;the&#x20;Ribbon&quot;&#x20;dropdown.&#x20;Make&#x20;sure&#x20;[v]Developer&#x20;is&#x20;marked&#x20;active.&#xD;&#xA;&#x9;-3-&#x20;How&#x20;to&#x20;add&#x20;a&#x20;Control&#x20;in&#x20;your&#x20;Microsoft&#x20;Word&#x20;template&#x20;to&#x20;hold&#x20;a&#x20;plain&#x20;value:&#xD;&#xA;&#x9;&#x9;Choose&#x20;&quot;Developer&quot;&#x20;from&#x20;the&#x20;main&#x20;menu.&#xD;&#xA;&#x9;&#x9;Click&#x20;&quot;Design&#x20;Mode&quot;&#xD;&#xA;&#x9;&#x9;Click&#x20;in&#x20;the&#x20;document&#x20;at&#x20;the&#x20;position&#x20;you&#x20;want&#x20;the&#x20;Control.&#xD;&#xA;&#x9;&#x9;Click&#x20;the&#x20;Plain&#x20;Text&#x20;Control&#x20;(or&#x20;the&#x20;Rich&#x20;text&#x20;Control)&#x20;symbol&#x20;(symbol&#x20;Aa&#x20;left&#x20;from&#x20;&quot;Design&#x20;Mode)&quot;&#xD;&#xA;&#x9;&#x9;&#x9;Now&#x20;you&#x20;will&#x20;see&#x20;the&#x20;Control&#x20;in&#x20;the&#x20;document.&#x20;&#xD;&#xA;&#x9;&#x9;Click&#x20;&quot;Properties&quot;&#x20;(just&#x20;under&#x20;&quot;Design&#x20;Mode&quot;)&#xD;&#xA;&#x9;&#x9;&#x9;In&#x20;the&#x20;Tag&#x20;field,&#x20;fill&#x20;the&#x20;name&#x20;that&#x20;you&#x20;will&#x20;use&#x20;when&#x20;passing&#x20;data,&#x20;e.g.&#x20;MYFIELD&#xD;&#xA;&#x9;&#x9;Save&#x20;the&#x20;template&#x20;and,&#x20;in&#x20;the&#x20;application,&#x20;invoke&#x20;the&#x20;Run&#x20;method&#x20;for&#x20;this&#x20;template.&#x20;Specify&#x20;a&#x20;value&#x20;for&#x20;MYFIELD.&#xD;&#xA;&#x9;&#x9;&#x9;Assuming&#x20;you&#x20;added&#x20;the&#x20;MYFIELD&#x20;text&#x20;Control&#x20;to&#x20;the&#x20;example&#x20;template,&#x20;see&#x20;a&#x20;result&#x20;by&#x20;executing:&#xD;&#xA;&#x9;&#x9;&#x9;invoke&#x20;OTS_WORD_LETTER.RUN&#x20;with&#x20;select&#x20;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;RulesEngine.Getproperty(&apos;TEMPDIR&apos;)&#x20;||&#x20;&apos;.OffTheShelfs\OTS_WORD_LETTER\OTS_Sample_WordReport.docx&apos;,&#x20;&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;RulesEngine.Getproperty(&apos;TEMPDIR&apos;)&#x20;||&#x20;&apos;Result.docx&apos;,&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&apos;MYFILED&apos;,&#x20;&apos;Hello&#x20;Controls&apos;&#xD;&#xA;&#x9;&#x9;&#x9;Use&#x20;the&#x20;ControlInfo&#x20;method&#x20;(as&#x20;shown&#x20;before)&#x20;to&#x20;see&#x20;the&#x20;MYFIELD&#x20;control&#x20;is&#x20;indeed&#x20;available.&#xD;&#xA;&#x9;&#x9;&#x9;Note&#x20;that&#x20;currently&#x20;no&#x20;rtf&#x20;(rich&#x20;text&#x20;format)&#x20;data&#x20;is&#x20;supported&#x20;in&#x20;the&#x20;component.&#xD;&#xA;&#x9;-4-&#x20;To&#x20;add&#x20;repeated&#x20;content&#x20;(table&#x20;data)&#xD;&#xA;&#x9;&#x9;-add&#x20;a&#x20;rich&#x20;text&#x20;content&#x20;control&#xD;&#xA;&#x9;&#x9;-set&#x20;the&#x20;Tag&#x20;property&#x20;of&#x20;this&#x20;control&#x20;to&#x20;the&#x20;same&#x20;value&#x20;as&#x20;the&#x20;NAME&#x20;attribute&#x20;in&#x20;the&#x20;xml&#x20;document&#xD;&#xA;&#x9;&#x9;-add&#x20;a&#x20;table&#x20;inside&#x20;the&#x20;control&#x20;with&#x20;one&#x20;row,&#x20;&#xD;&#xA;&#x9;&#x9;&#x9;-in&#x20;that&#x20;row&#x20;add&#x20;new&#x20;(rich&#x20;text)&#x20;content&#x20;control&#x20;for&#x20;each&#x20;field.&#xD;&#xA;&#x9;-5-&#x20;The&#x20;other&#x20;Microsoft&#x20;Word&#x20;controls&#x20;are&#x20;not&#x20;implemented&#x20;except&#x20;the&#x20;Date&#x20;Picker&#x20;Control.&#xD;&#xA;&#x9;&#x9;For&#x20;the&#x20;Date&#x20;Picker&#x20;Control,&#x20;the&#x20;component&#x20;will&#x20;try&#x20;to&#x20;parse&#x20;the&#x20;data&#x20;as&#x20;DateTime&#x20;and&#x20;format&#x20;the&#x20;DateTime&#x20;according&#x20;to&#x20;the&#x20;format&#x20;specified&#x20;for&#x20;the&#x20;Date&#x20;Picker&#x20;Control.&#x20;The&#x20;advanced&#x20;example&#x20;below&#x20;uses&#x20;the&#x20;Date&#x20;Picker&#x20;control.&#xD;&#xA;&#x9;&#x9;&#xD;&#xA;The&#x20;following&#x20;advanced&#x20;examples&#x20;assume&#x20;that&#x20;you&#x20;are&#x20;working&#x20;with&#x20;the&#x20;USoft&#x20;Travel&#x20;Agency&#x20;example&#x20;(a&#x20;course&#x20;material&#x20;example).&#xD;&#xA;Note&#x20;that&#x20;you&#x20;can&#x20;copy&#x20;the&#x20;templates&#x20;to&#x20;your&#x20;own&#x20;(template)&#x20;directory&#x20;to&#x20;avoid&#x20;the&#x20;paths&#x20;to&#x20;the&#x20;USoft&#x20;OffTheShelf&#x20;directory&#x20;in&#x20;the&#x20;examples.&#xD;&#xA;That&#x20;also&#x20;allows&#x20;you&#x20;to&#x20;experiment&#x20;and&#x20;change&#x20;the&#x20;templates&#x20;while&#x20;keeping&#x20;the&#x20;original.&#xD;&#xA;Of&#x20;course&#x20;you&#x20;can&#x20;change&#x20;the&#x20;SQL&#x20;used&#x20;in&#x20;the&#x20;example&#x20;(and/or&#x20;the&#x20;template)&#x20;to&#x20;match&#x20;your&#x20;own&#x20;USoft&#x20;data&#x20;model.&#xD;&#xA;&#xD;&#xA;To&#x20;find&#x20;the&#x20;Controls&#x20;in&#x20;the&#x20;OTS_TravelTemplate.docx&#x20;example,&#x20;execute::&#xD;&#xA;&#x9;select&#x20;OTS_WORD_LETTER.ControlInfo(&#x20;RulesEngine.Getproperty(&apos;TEMPDIR&apos;)&#x20;||&#x20;&apos;.OffTheShelfs\OTS_WORD_LETTER\OTS_TravelTemplate.docx&apos;&#x20;&#x20;);&#xD;&#xA;Assuming&#x20;you&#x20;copied&#x20;OTS_TravelTemplate.docx&#x20;to&#x20;c:\temp&#x20;that&#x20;would&#x20;be:&#xD;&#xA;&#x9;select&#x20;OTS_WORD_LETTER.ControlInfo(&#x20;&#x20;&apos;c:\temp\OTS_TravelTemplate.docx&apos;&#x20;&#x20;);&#xD;&#xA;&#x9;&#xD;&#xA;Now&#x20;the&#x20;idea&#x20;is&#x20;to&#x20;fill&#x20;the&#x20;available&#x20;Controls&#x20;as&#x20;follows:&#xD;&#xA;&#x9;-1-&#x20;a&#x20;list&#x20;of&#x20;reservations&#x20;in&#x20;a&#x20;Control&#x20;with&#x20;tag&#x20;&quot;ALL_RESERVATIONS&quot;&#xD;&#xA;&#x9;&#x9;Note:&#x20;you&#x20;will&#x20;need&#x20;to&#x20;import&#x20;the&#x20;OTS_STRING&#x20;Off&#x20;The&#x20;Shelf&#x20;component&#x20;too&#x20;for&#x20;this&#x20;example.&#x20;It&#x20;contains&#x20;an&#x20;record&#x20;aggregate&#x20;used&#x20;for&#x20;the&#x20;data&#x20;passed&#x20;to&#x20;ALL_RESERVATIONS&#xD;&#xA;&#x9;-2-&#x20;to&#x20;fill&#x20;a&#x20;Control&#x20;with&#x20;tag&#x20;name&#x20;&quot;GENDER&quot;&#x20;using&#x20;a&#x20;SQL&#x20;DECODE&#x20;statement&#xD;&#xA;&#x9;-3-&#x20;to&#x20;fill&#x20;a&#x20;Control&#x20;with&#x20;tag&#x20;name&#x20;NAME&#x20;using&#x20;a&#x20;concatenation&#xD;&#xA;&#x9;-4-&#x20;to&#x20;fill&#x20;a&#x20;Control&#x20;RESERVATIONS_TABLE&#x20;from&#x20;an&#x20;xml.sqlexport&#xD;&#xA;&#xD;&#xA;To&#x20;produce&#x20;the&#x20;result&#x20;document:&#xD;&#xA;&#xD;&#xA;invoke&#x20;OTS_WORD_LETTER.RUN&#x20;with&#x20;select&#x20;&#xD;&#xA;&#x9;RulesEngine.Getproperty(&apos;TEMPDIR&apos;)&#x20;||&#x20;&apos;.OffTheShelfs\OTS_WORD_LETTER\OTS_TravelTemplate.docx&apos;,&#xD;&#xA;&#x9;&apos;c:\temp\Reservation&apos;&#x20;||&#x20;p.person_id&#x20;||&#x20;&apos;.docx&apos;,&#xD;&#xA;&#x9;&apos;ALL_RESERVATIONS&apos;,&#xD;&#xA;&#x9;(&#x20;invoke&#x20;OTS_STRING.RecordConcat&#x20;with&#x20;select&#x20;&apos;&apos;,&#x20;&apos;,&apos;,&#x20;res_id&#x20;from&#x20;reservations&#x20;rr,&#x20;tour&#x20;ss&#x20;relate&#x20;p&#x20;MAKES&#x20;rr,&#x20;ss&#x20;&quot;FOR&#x20;WHICH&#x20;IS&#x20;MADE&quot;&#x20;rr),&#xD;&#xA;&#x9;&apos;GENDER&apos;,&#x20;decode(p.GENDER,&#x20;&apos;M&apos;,&#x20;&apos;Mr&apos;,&#x20;&apos;F&apos;,&#x20;&apos;Ms&apos;,&#x20;&apos;&apos;),&#xD;&#xA;&#x9;&apos;NAME&apos;,&#x20;&#x20;p.FIRST_NAME&#x20;||&#x20;&apos;&#x20;&apos;&#x20;||&#x20;p.FAMILY_NAME,&#xD;&#xA;&#x9;&apos;RESERVATIONS_TABLE&apos;,&#x20;&#xD;&#xA;&#x9;(&#xD;&#xA;&#x9;&#x9;invoke&#x20;xml.sqlexport&#x20;with&#x20;select&#xD;&#xA;&#x9;&#x9;&#x9;r.RES_ID,&#xD;&#xA;&#x9;&#x9;&#x9;s.TOUR_TYPE,&#x20;s.DESTINATION,&#xD;&#xA;&#x9;&#x9;&#x9;s.START_DATE,&#x20;s.RETURN_DATE&#x9;&#x9;&#xD;&#xA;&#x9;&#x9;from&#xD;&#xA;&#x9;&#x9;&#x9;reservation&#x20;r,&#x20;tour&#x20;s&#xD;&#xA;&#x9;&#x9;relate&#xD;&#xA;&#x9;&#x9;&#x9;p&#x20;MAKES&#x20;r,&#x20;s&#x20;&quot;FOR&#x20;WHICH&#x20;IS&#x20;MADE&quot;&#x20;r&#xD;&#xA;&#x9;)&#xD;&#xA;FROM&#xD;&#xA;&#x9;PERSON&#x20;p&#xD;&#xA;WHERE&#x20;exists&#x20;&#xD;&#xA;(&#xD;&#xA;&#x9;select&#x20;&#xD;&#xA;&#x9;&#x9;&apos;has&#x20;reservation&apos;&#x20;&#xD;&#xA;&#x9;from&#xD;&#xA;&#x9;&#x9;reservations&#x20;rrr,&#x20;tour&#x20;sss&#x20;&#xD;&#xA;&#x9;relate&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;p&#x20;MAKES&#x20;rrr,&#x20;sss&#x20;&quot;FOR&#x20;WHICH&#x20;IS&#x20;MADE&quot;&#x20;rrr&#xD;&#xA;)&#xD;&#xA;AND&#xD;&#xA;&#x9;p.person_id&#x20;=&#x20;1&#xD;&#xA;&#xD;&#xA;If&#x20;you&#x20;omit&#x20;the&#x20;condition&#x20;&quot;AND&#x20;p.person_id=1&quot;&#x20;you&#x20;will&#x20;see&#x20;that&#x20;all&#x20;documents&#x20;for&#x20;each&#x20;person&#x20;with&#x20;reservations&#x20;are&#x20;produced&#x20;instantly&#x20;and&#x20;fast.&#xD;&#xA;&#xD;&#xA;You&#x20;could&#x20;use&#x20;this&#x20;SQL&#x20;(without&#x20;the&#x20;limitation&#x20;on&#x20;person_id)&#x20;in&#x20;a&#x20;logical&#x20;view&#x20;to&#x20;let&#x20;it&#x20;produce&#x20;documents&#x20;on&#x20;demand.&#xD;&#xA;Make&#x20;a&#x20;logical&#x20;view&#x20;with&#x20;name&#x20;e.g.&#x20;RESERVATION_REPORT&#x20;and&#x20;SQL:&#xD;&#xA;SELECT&#xD;&#xA;&#x9;p.PERSON_ID,&#xD;&#xA;&#x9;OTS_WORD_LETTER.RUN&#xD;&#xA;&#x9;(&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;RulesEngine.Getproperty(&apos;TEMPDIR&apos;)&#x20;||&#x20;&apos;.OffTheShelfs\OTS_WORD_LETTER\OTS_TravelTemplate.docx&apos;,&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&apos;c:\temp\Reservation&apos;&#x20;||&#x20;p.PERSON_ID&#x20;||&#x20;&apos;.docx&apos;,&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&apos;ALL_RESERVATIONS&apos;,&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;(&#x20;invoke&#x20;OTS_STRING.RecordConcat&#x20;with&#x20;select&#x20;&apos;&apos;,&#x20;&apos;,&#x20;&apos;,&#x20;res_id&#x20;from&#x20;reservations&#x20;rr,&#x20;tour&#x20;ss&#x20;relate&#x20;p&#x20;MAKES&#x20;rr,&#x20;ss&#x20;&quot;FOR&#x20;WHICH&#x20;IS&#x20;MADE&quot;&#x20;rr),&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&apos;GENDER&apos;,&#x20;decode(p.GENDER,&#x20;&apos;M&apos;,&#x20;&apos;Mr.&apos;,&#x20;&apos;F&apos;,&#x20;&apos;Ms.&apos;,&#x20;&apos;&apos;),&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&apos;NAME&apos;,&#x20;&#x20;p.FIRST_NAME&#x20;||&#x20;&apos;&#x20;&apos;&#x20;||&#x20;p.FAMILY_NAME,&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&apos;RESERVATIONS_TABLE&apos;,&#x20;&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;(&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;invoke&#x20;xml.sqlexport&#x20;with&#x20;select&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;r.RES_ID,&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;s.TOUR_TYPE,&#x20;s.DESTINATION,&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;s.START_DATE,&#x20;s.RETURN_DATE&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;from&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;reservation&#x20;r,&#x20;tour&#x20;s&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;relate&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;p&#x20;MAKES&#x20;r,&#x20;s&#x20;&quot;FOR&#x20;WHICH&#x20;IS&#x20;MADE&quot;&#x20;r&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;)&#xD;&#xA;&#x9;)&#x20;&quot;FILEPATH&quot;&#xD;&#xA;FROM&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;PERSON&#x20;p&#xD;&#xA;WHERE&#x20;exists&#x20;&#xD;&#xA;(&#xD;&#xA;&#x9;select&#x20;&#xD;&#xA;&#x9;&#x9;&apos;has&#x20;reservation&apos;&#x20;&#xD;&#xA;&#x9;from&#xD;&#xA;&#x9;&#x9;reservations&#x20;rrr,&#x20;tour&#x20;sss&#x20;&#xD;&#xA;&#x9;relate&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;p&#x20;MAKES&#x20;rrr,&#x20;sss&#x20;&quot;FOR&#x20;WHICH&#x20;IS&#x20;MADE&quot;&#x20;rrr&#xD;&#xA;)&#xD;&#xA;Try&#x20;this&#x20;logical&#x20;view&#x20;in&#x20;the&#x20;application&#x20;by&#x20;querying&#x20;a&#x20;person&#x20;that&#x20;has&#x20;reservations&#x20;(a&#x20;reservation&#x20;report&#x20;will&#x20;be&#x20;generated),&#x20;querying&#x20;a&#x20;person&#x20;with&#x20;no&#x20;reservations&#x20;and&#x20;finally&#x20;querying&#x20;all&#x20;(all&#x20;reports&#x20;will&#x20;be&#x20;generated).&#xD;&#xA;As&#x20;a&#x20;final&#x20;example&#x20;that&#x20;passes&#x20;all&#x20;data&#x20;via&#x20;a&#x20;propriety&#x20;xml&#x20;format&#x20;(as&#x20;opposed&#x20;to&#x20;passing&#x20;name&#x20;-&#x20;vale/xml.[sql]export&#x20;pairs),&#x20;try&#x20;in&#x20;the&#x20;Application/SqlCommand&#x20;this&#x20;call&#x20;with&#x20;inline&#x20;data:&#xD;&#xA;&#xD;&#xA;invoke&#x20;OTS_WORD_LETTER.RUN&#x20;with&#x20;select&#x20;&#xD;&#xA;&#x9;RulesEngine.Getproperty(&apos;TEMPDIR&apos;)&#x20;||&#x20;&apos;.OffTheShelfs\OTS_WORD_LETTER\OTS_Sample_WordReport.docx&apos;,&#x20;&#xD;&#xA;&#x9;&apos;c:\temp\Result.docx&apos;,&#xD;&#xA;&#x9;&apos;&lt;Report&gt;&#xD;&#xA;&#x9;&lt;PAS_NUMBER&gt;000&lt;/PAS_NUMBER&gt;&#xD;&#xA;&#x9;&lt;GENDER&gt;Mr.&lt;/GENDER&gt;&#xD;&#xA;&#x9;&lt;NAME&gt;Whoever&lt;/NAME&gt;&#xD;&#xA;&#x9;&lt;Table&#x20;NAME=&quot;BOOK_TABLE&quot;&gt;&#xD;&#xA;&#x9;&#x9;&lt;Row&gt;&#xD;&#xA;&#x9;&#x9;&#x9;&lt;NAME&gt;&lt;![CDATA[Harry&#x20;Potter&#x20;and&#x20;the&#x20;Philosopher&apos;&apos;s&#x20;Stone]]&gt;&lt;/NAME&gt;&#xD;&#xA;&#x9;&#x9;&#x9;&lt;AUTHOR&gt;&lt;![CDATA[J.&#x20;K.&#x20;Rowling]]&gt;&lt;/AUTHOR&gt;&#xD;&#xA;&#x9;&#x9;&#x9;&lt;DUE_DATE&gt;01-JAN-2020&lt;/DUE_DATE&gt;&#xD;&#xA;&#x9;&#x9;&lt;/Row&gt;&#xD;&#xA;&#x9;&#x9;&lt;Row&gt;&#xD;&#xA;&#x9;&#x9;&#x9;&lt;NAME&gt;&lt;![CDATA[Harry&#x20;Potter&#x20;and&#x20;the&#x20;Chamber&#x20;of&#x20;Secrets]]&gt;&lt;/NAME&gt;&#xD;&#xA;&#x9;&#x9;&#x9;&lt;AUTHOR&gt;&lt;![CDATA[J.&#x20;K.&#x20;Rowling]]&gt;&lt;/AUTHOR&gt;&#xD;&#xA;&#x9;&#x9;&#x9;&lt;DUE_DATE&gt;01-MAR-2020&lt;/DUE_DATE&gt;&#xD;&#xA;&#x9;&#x9;&lt;/Row&gt;&#x9;&#xD;&#xA;&#x9;&lt;/Table&gt;&#xD;&#xA;&lt;/Report&gt;&apos;</Description>
</OTS>