<?xml version="1.0" encoding="UTF-8"?>
<esi:global version="1.0" xmlns:esi="http://www.usoft.com/Product/Esi" type="export">
	<esi:application action="container">
		<esi:library name="Page" access_type="stylesheet" read_only="false" created_by="usoft" created_on="2022/0812145332" description="" action="container">
			<esi:library name="EventListener" access_type="ownership" read_only="false" created_by="usoft" created_on="2022/0812145332" description="" action="container">
				<esi:class name="ChangePassword" access_type="ownership" read_only="false" created_by="usoft" created_on="2022/0812145332" description="" action="replace">
					<esi:heritage name="executeSQLStatement"/>
					<esi:property name="sql" value="select&#x20;BatchRunner.[USOFT_CHANGE_PASSWORD_JOB]&#xD;&#xA;&#x9;&#x9;(&#x9;&apos;True&apos;&#x9;&#x9;&#x9;&quot;-quiet&quot;&#xD;&#xA;&#x9;&#x9;,&#x9;:username&#x9;&quot;USERNAME&quot;&#xD;&#xA;&#x9;&#x9;,&#x9;:newpassword&#x9;&quot;NEW_PASSWORD&quot;&#xD;&#xA;&#x9;&#x9;,&#x9;:oldpassword&#x9;&quot;OLD_PASSWORD&quot;&#xD;&#xA;&#x9;&#x9;,&#x9;:confirmnewpassword&#x9;&quot;CONFIRM_NEW_PASSWORD&quot;&#xD;&#xA;&#x9;&#x9;)&#x9;&quot;Result&quot;"/>
				</esi:class>
				<esi:class name="callChangePassword" access_type="ownership" read_only="false" created_by="usoft" created_on="2022/0829162204" description="" action="replace">
					<esi:heritage name="callClientScript"/>
					<esi:property name="script" value="//&#x20;Get&#x20;the&#x20;user&#xD;&#xA;var&#x20;username&#x20;=&#x20;$.udb(&apos;USER_CURRENT&apos;).rows(0).cols(&apos;[C_USERNAME]&apos;).val();&#xD;&#xA;&#xD;&#xA;//&#x20;Get&#x20;form&#x20;input&#x20;from&#x20;a&#x20;VariableSetDataSource&#xD;&#xA;var&#x20;oldpassword&#x20;=&#x20;$(&quot;input#old-password&quot;).val();&#xD;&#xA;var&#x20;newpassword&#x20;=&#x20;$(&quot;input#new-password&quot;).val();&#xD;&#xA;var&#x20;confirmnewpassword&#x20;=&#x20;$(&quot;input#confirm-password&quot;).val();&#xD;&#xA;&#xD;&#xA;//&#x20;Semantic&#x20;checking&#xD;&#xA;if&#x20;(!oldpassword&#x20;||&#x20;!newpassword&#x20;||&#x20;!confirmnewpassword)&#x20;{&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;$.udb.msg.displayMessage(&apos;Not&#x20;all&#x20;required&#x20;fields&#x20;are&#x20;filled&#x20;in.&apos;);&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;return;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;if&#x20;(newpassword&#x20;===&#x20;oldpassword)&#x20;{&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;$.udb.msg.displayMessage(&apos;The&#x20;new&#x20;password&#x20;and&#x20;the&#x20;old&#x20;password&#x20;are&#x20;equal.&apos;);&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;return;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;if&#x20;(newpassword&#x20;!==&#x20;confirmnewpassword)&#x20;{&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;$.udb.msg.displayMessage(&apos;The&#x20;new&#x20;password&#x20;and&#x20;the&#x20;confirm&#x20;password&#x20;differ.&apos;);&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;return;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;$.udb.executeSQLStatement(&apos;PasswordChange&apos;,&#x20;{&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;waitState:&#x20;true,&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;hostvars:&#x20;{&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;username,&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;oldpassword,&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;newpassword,&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;confirmnewpassword&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;},&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;success:function()&#x20;{&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;$.udb.commit({&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;waitState:&#x20;true,&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;quiet:&#x20;true,&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;success:&#x20;function(state)&#x20;{&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;var&#x20;result&#x20;=&#x20;$.udb(&apos;JobResult&apos;).rows(&apos;current&apos;).cols(&apos;Result&apos;).val();&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;if(result&#x20;!=&#x20;&quot;Y&quot;)&#x20;{&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;$.udb.msg.displayMessage(result);&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;return;&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;}&#xD;&#xA;&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;window.location.search&#x20;=&#x20;window.location.search&#x20;+&#x20;&apos;&amp;username=&apos;&#x20;+&#x20;username&#x20;+&#x20;&apos;&amp;resetpwsuccess=y&amp;language=&apos;&#x20;+&#x20;language;&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;$.udb.logout();&#xD;&#xA;&#x9;&#x9;&#x9;},&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x9;error:&#x20;function(state)&#x20;{&#xD;&#xA;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;$.udb.msg.displayMessage(&apos;Change&#x20;password:&#x20;fail&apos;,&#x20;&quot;Error&quot;);&#xD;&#xA;&#x9;&#x9;&#x9;}&#xD;&#xA;&#x9;&#x9;});&#xD;&#xA;&#x9;}&#xD;&#xA;});"/>
				</esi:class>
			</esi:library>
		</esi:library>
	</esi:application>
</esi:global>