<?xml version="1.0" encoding="utf-8"?>
<?usoft-xml version="1.0" action="multi-tables-import"?>
<MultiImport>
  <Columns>
    <T_COLUMN TABLE_NAME="[USOFT_T_USER]" COLUMN_NAME="[C_PASSWORD_HASHED]" DOMAIN_NAME="[D_PASSWORD_HASHED]" PROMPT="P_PASSWORD_HASHED" KEYORDER="N" MANDATORY="Y" INPUT_ALLOWED="Y" UPDATABLE="Y" QUERY_ALLOWED="Y" COLUMN_TYPE="D" DISPLAYED="Y" DEF_VALUE="" SEQNO="11" LOFSEQNO="" PERC_FULL="50" PERC_NULL="0" HELP_TEXT="" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y" UNDER_VC="Y" />
    <T_COLUMN TABLE_NAME="[USOFT_T_USER]" COLUMN_NAME="[C_USERNAME]" DOMAIN_NAME="[D_USERNAME]" PROMPT="P_USERNAME" KEYORDER="1" MANDATORY="Y" INPUT_ALLOWED="Y" UPDATABLE="Y" QUERY_ALLOWED="Y" COLUMN_TYPE="D" DISPLAYED="Y" DEF_VALUE="" SEQNO="10" LOFSEQNO="" PERC_FULL="50" PERC_NULL="0" HELP_TEXT="" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y" UNDER_VC="Y" />
  </Columns>
  <Domains>
    <T_DOMAIN DOMAIN_NAME="[D_PASSWORD_HASHED]" SUPER_DOMAIN="" DATATYPE="VARCHAR2" TOTAL_LENGTH="1024" LENGTH_AFTER_PERIOD="" F_DATATYPE="CHAR" F_TOTAL_LENGTH="1" F_LENGTH_AFTER_PERIOD="" DISPLAY_LENGTH="" UPPERCASE="N" FIXED_LENGTH="N" IS_SEQNO="N" DEF_VALUE="" RANGE_LOW="" RANGE_HIGH="" HELP_TEXT="" IOFORMAT="" DBFORMAT="" DESCR="" PERC_FULL="50" SEQNO_COMPONENT="" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y" REGEXP="" />
    <T_DOMAIN DOMAIN_NAME="[D_USERNAME]" SUPER_DOMAIN="" DATATYPE="VARCHAR2" TOTAL_LENGTH="1024" LENGTH_AFTER_PERIOD="" F_DATATYPE="CHAR" F_TOTAL_LENGTH="1" F_LENGTH_AFTER_PERIOD="" DISPLAY_LENGTH="" UPPERCASE="N" FIXED_LENGTH="N" IS_SEQNO="N" DEF_VALUE="" RANGE_LOW="" RANGE_HIGH="" HELP_TEXT="" IOFORMAT="" DBFORMAT="" DESCR="" PERC_FULL="50" SEQNO_COMPONENT="" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y" REGEXP="" />
  </Domains>
  <External_Set_Elements>
    <T_EXT_SETELEMENT SET_NAME="[USOFT_PASSWORD_OUT_PAR]" SEQNO="10" ELEMENT_NAME="RESULT" DATATYPE="NVARCHAR" TOTAL_LENGTH="512" TC_FORMAT="" CHILD_SET="" INTERFACE="Y" MODULE="" INTERFACE_CORRECT="Y" />
    <T_EXT_SETELEMENT SET_NAME="[USOFT_PASSWORD_PAR]" SEQNO="10" ELEMENT_NAME="USERNAME" DATATYPE="NVARCHAR" TOTAL_LENGTH="256" TC_FORMAT="" CHILD_SET="" INTERFACE="Y" MODULE="" INTERFACE_CORRECT="Y" />
    <T_EXT_SETELEMENT SET_NAME="[USOFT_PASSWORD_PAR]" SEQNO="20" ELEMENT_NAME="PASSWORD" DATATYPE="NVARCHAR" TOTAL_LENGTH="256" TC_FORMAT="" CHILD_SET="" INTERFACE="Y" MODULE="" INTERFACE_CORRECT="Y" />
    <T_EXT_SETELEMENT SET_NAME="[USOFT_PASSWORD_PAR]" SEQNO="24" ELEMENT_NAME="OLD_PASSWORD" DATATYPE="NVARCHAR" TOTAL_LENGTH="256" TC_FORMAT="" CHILD_SET="" INTERFACE="Y" MODULE="" INTERFACE_CORRECT="Y" />
    <T_EXT_SETELEMENT SET_NAME="[USOFT_PASSWORD_PAR]" SEQNO="26" ELEMENT_NAME="NEW_PASSWORD" DATATYPE="NVARCHAR" TOTAL_LENGTH="256" TC_FORMAT="" CHILD_SET="" INTERFACE="Y" MODULE="" INTERFACE_CORRECT="Y" />
    <T_EXT_SETELEMENT SET_NAME="[USOFT_PASSWORD_PAR]" SEQNO="27" ELEMENT_NAME="CONFIRM_NEW_PASSWORD" DATATYPE="NVARCHAR" TOTAL_LENGTH="256" TC_FORMAT="" CHILD_SET="" INTERFACE="Y" MODULE="" INTERFACE_CORRECT="Y" />
    <T_EXT_SETELEMENT SET_NAME="[USOFT_PASSWORD_PAR]" SEQNO="50" ELEMENT_NAME="IS_VALID" DATATYPE="NVARCHAR" TOTAL_LENGTH="1" TC_FORMAT="" CHILD_SET="" INTERFACE="Y" MODULE="" INTERFACE_CORRECT="Y" />
    <T_EXT_SETELEMENT SET_NAME="[USOFT_PASSWORD_PAR]" SEQNO="60" ELEMENT_NAME="RESULT" DATATYPE="NVARCHAR" TOTAL_LENGTH="512" TC_FORMAT="" CHILD_SET="" INTERFACE="Y" MODULE="" INTERFACE_CORRECT="Y" />
  </External_Set_Elements>
  <External_Sets>
    <T_EXT_SET SET_NAME="[USOFT_PASSWORD_OUT_PAR]" FILEFORMAT="VARIA" ROWSEPARATOR="\n" T_EXT_SET_HTML="N" SQLSTATEMENT="" DESCRIPTION="" T_EXT_SET_TABLEBASED="N" INTERFACE="Y" MODULE="" INTERFACE_CORRECT="Y" />
    <T_EXT_SET SET_NAME="[USOFT_PASSWORD_PAR]" FILEFORMAT="VARIA" ROWSEPARATOR="\n" T_EXT_SET_HTML="N" SQLSTATEMENT="" DESCRIPTION="" T_EXT_SET_TABLEBASED="N" INTERFACE="Y" MODULE="" INTERFACE_CORRECT="Y" />
  </External_Sets>
  <Job_Comments>
    <T_JOB_COMMENT JOB_NAME="[USOFT_CHANGE_PASSWORD_JOB]" COM_TEXT="Call change own password" />
  </Job_Comments>
  <Jobs>
    <T_JOB JOB_NAME="[USOFT_CHANGE_PASSWORD_JOB]" SET_NAME="[USOFT_PASSWORD_PAR]" USE_USER_TABLE="N" USER_TABLE="" OUTPUT_SET_NAME="[USOFT_PASSWORD_OUT_PAR]" USE_OUTPUT_USER_TABLE="N" OUTPUT_USER_TABLE="" COMMITTYPE="TASK" INTERFACE="Y" MODULE="" INTERFACE_CORRECT="Y" ACTIVE="Y" />
  </Jobs>
  <SQL_Task_Statements>
    <T_SQLTASK_STATEMENT SQLTASK_NAME="[USOFT_CHANGE_PASSWORD_TASK]" SEQNO="10" ACTIVE="Y" DISABLE_RULES="N" SQLSTATEMENT="invoke&#x9;RulesEngine.StartCatchingErrors" DESCRIPTION="Start catching errors" />
    <T_SQLTASK_STATEMENT SQLTASK_NAME="[USOFT_CHANGE_PASSWORD_TASK]" SEQNO="20" ACTIVE="Y" DISABLE_RULES="N" SQLSTATEMENT="update&#x9;[USOFT_PASSWORD_PAR] par&#xD;&#xA;set&#x9;&#x9;result = NULL" DESCRIPTION="Initialize parameter set" />
    <T_SQLTASK_STATEMENT SQLTASK_NAME="[USOFT_CHANGE_PASSWORD_TASK]" SEQNO="30" ACTIVE="Y" DISABLE_RULES="N" SQLSTATEMENT="update&#x9;[USOFT_PASSWORD_PAR] par&#xD;&#xA;set&#x9;&#x9;result = 'Not all required fields are filled in.'&#xD;&#xA;where&#x9;par.username is null&#xD;&#xA;or&#x9;&#x9;par.old_password is null&#xD;&#xA;or&#x9;&#x9;par.new_password is null&#xD;&#xA;or&#x9;&#x9;par.confirm_new_password is null" DESCRIPTION="Check required fields" />
    <T_SQLTASK_STATEMENT SQLTASK_NAME="[USOFT_CHANGE_PASSWORD_TASK]" SEQNO="40" ACTIVE="Y" DISABLE_RULES="N" SQLSTATEMENT="update&#x9;[USOFT_PASSWORD_PAR]  par&#xD;&#xA;set&#x9;&#x9;result = 'Old password is not correct'&#xD;&#xA;where&#x9;par.result = 'Y'&#xD;&#xA;and&#x9;&#x9;exists&#xD;&#xA;(&#x9;&#x9;select&#x9;''&#xD;&#xA;&#x9;&#x9;from&#x9;[USOFT_T_USER] usr&#xD;&#xA;&#x9;&#x9;where&#x9;usr.[C_USERNAME] = par.username&#xD;&#xA;&#x9;&#x9;and&#x9;&#x9;USCoder.Hash(par.old_password) != usr.[C_PASSWORD_HASHED]&#xD;&#xA;)" DESCRIPTION="Check old password" />
    <T_SQLTASK_STATEMENT SQLTASK_NAME="[USOFT_CHANGE_PASSWORD_TASK]" SEQNO="45" ACTIVE="Y" DISABLE_RULES="N" SQLSTATEMENT="update&#x9;[USOFT_PASSWORD_PAR]  par&#xD;&#xA;set&#x9;&#x9;result = 'New password is equal to the old password'&#xD;&#xA;where&#x9;par.result = 'Y'&#xD;&#xA;and&#x9;&#x9;(&#x9;par.old_password = par.new_password&#xD;&#xA;&#x9;&#x9;or&#x9;exists&#xD;&#xA;&#x9;&#x9;(&#x9;select&#x9;''&#xD;&#xA;&#x9;&#x9;&#x9;from&#x9;[USOFT_T_USER] usr&#xD;&#xA;&#x9;&#x9;&#x9;where&#x9;usr.[C_USERNAME] = par.username&#xD;&#xA;&#x9;&#x9;&#x9;and&#x9;&#x9;USCoder.Hash(par.new_password) = usr.[C_PASSWORD_HASHED]&#xD;&#xA;&#x9;&#x9;)&#xD;&#xA;&#x9;&#x9;)" DESCRIPTION="Check old password not equal to new password" />
    <T_SQLTASK_STATEMENT SQLTASK_NAME="[USOFT_CHANGE_PASSWORD_TASK]" SEQNO="46" ACTIVE="Y" DISABLE_RULES="N" SQLSTATEMENT="update&#x9;[USOFT_PASSWORD_PAR]  par&#xD;&#xA;set&#x9;&#x9;result = 'New password is not equal to the confirmed password'&#xD;&#xA;where&#x9;par.result = 'Y'&#xD;&#xA;and&#x9;&#x9;par.new_password != par.confirm_new_password" DESCRIPTION="Check new password equal to confirmed" />
    <T_SQLTASK_STATEMENT SQLTASK_NAME="[USOFT_CHANGE_PASSWORD_TASK]" SEQNO="47" ACTIVE="Y" DISABLE_RULES="N" SQLSTATEMENT="update&#x9;[USOFT_PASSWORD_PAR] par&#xD;&#xA;set&#x9;&#x9;result = 'Password is not strong enought. Please provide a stronger password'&#xD;&#xA;where&#x9;par.result = 'Y'&#xD;&#xA;and&#x9;&#x9;par.new_password = par.confirm_new_password&#xD;&#xA;and&#x9;&#x9;0 = usformat.check&#xD;&#xA;&#x9;&#x9;(&#x9;par.new_password&#xD;&#xA;&#x9;&#x9;,&#x9;'((?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[\W]).{8,64})'&#xD;&#xA;&#x9;&#x9;)" DESCRIPTION="Check password strength" />
    <T_SQLTASK_STATEMENT SQLTASK_NAME="[USOFT_CHANGE_PASSWORD_TASK]" SEQNO="50" ACTIVE="Y" DISABLE_RULES="N" SQLSTATEMENT="update&#x9;[USOFT_T_USER] usr&#xD;&#xA;set&#x9;&#x9;[C_PASSWORD_HASHED] = &#xD;&#xA;(&#x9;&#x9;select&#x9;USCoder.Hash(par.new_password)&#xD;&#xA;&#x9;&#x9;from&#x9;[USOFT_PASSWORD_PAR] par&#xD;&#xA;)&#xD;&#xA;where&#x9;exists&#xD;&#xA;(&#x9;&#x9;select&#x9;''&#xD;&#xA;&#x9;&#x9;from&#x9;[USOFT_PASSWORD_PAR] par&#xD;&#xA;&#x9;&#x9;where&#x9;par.result = 'Y'&#xD;&#xA;)&#xD;&#xA;and&#x9;&#x9;usr.[C_USERNAME] = &#xD;&#xA;(&#x9;&#x9;select&#x9;par.username&#xD;&#xA;&#x9;&#x9;from&#x9;[USOFT_PASSWORD_PAR] par&#xD;&#xA;)" DESCRIPTION="Change the password" />
    <T_SQLTASK_STATEMENT SQLTASK_NAME="[USOFT_CHANGE_PASSWORD_TASK]" SEQNO="60" ACTIVE="Y" DISABLE_RULES="N" SQLSTATEMENT="update&#x9;[USOFT_PASSWORD_PAR] par&#xD;&#xA;set&#x9;&#x9;result = nvl(RulesEngine.GetLastCaughtErrors(), 'Y') &#xD;&#xA;where&#x9;par.result = 'Y'" DESCRIPTION="Check for any errors" />
    <T_SQLTASK_STATEMENT SQLTASK_NAME="[USOFT_CHANGE_PASSWORD_TASK]" SEQNO="70" ACTIVE="Y" DISABLE_RULES="N" SQLSTATEMENT="invoke&#x9;RulesEngine.StopCatchingErrors" DESCRIPTION="Stop catching errors" />
    <T_SQLTASK_STATEMENT SQLTASK_NAME="[USOFT_CHANGE_PASSWORD_TASK]" SEQNO="700" ACTIVE="Y" DISABLE_RULES="N" SQLSTATEMENT="insert into [USOFT_PASSWORD_OUT_PAR] &#xD;&#xA;(&#x9;&#x9;result&#xD;&#xA;)&#xD;&#xA;select&#x9;nvl(par.result, '')&#xD;&#xA;from&#x9;[USOFT_PASSWORD_PAR] par" DESCRIPTION="Return the result" />
  </SQL_Task_Statements>
  <SQL_Tasks>
    <T_SQLTASK SQLTASK_NAME="[USOFT_CHANGE_PASSWORD_TASK]" />
  </SQL_Tasks>
  <Tables>
    <T_TABLE TABLE_NAME="[USOFT_T_USER]" TABLE_SHORT="U_A" OBJECT_NAME="User account" OBJECT_NAME_PLURAL="User accounts" KEYHIDDEN="N" CRETAB="N" UPDATED="Y" STATIC_TABLE="N" INIT_NR_OF_ROWS="1000" NEXT_NR_OF_ROWS="500" T_SUBT_SUPERTYPE="" T_SUBT_SEPARATE_TABLE="Y" DELETE_SUPER_ON_DELETE="N" T_LOGICAL_VIEW="N" T_COMPONENT_TABLE="N" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y" INTERFACE_SOURCE="" UNDER_VC="N" DELIVERABLE="N" />
  </Tables>
  <Tasks>
    <T_JOB_TASK JOB_NAME="[USOFT_CHANGE_PASSWORD_JOB]" JOB_TASK_NAME="[USOFT_CHANGE_PASSWORD_TASK]" SEQNO="10" COMMITTYPE="TASK" ABORT_MODE="JOB" IS_ACTION="" IS_EXPORT="" IS_IMPORT="" IS_JOB="" IS_SQL="[USOFT_CHANGE_PASSWORD_TASK]" />
  </Tasks>
</MultiImport>