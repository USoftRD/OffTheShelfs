<?xml version="1.0" encoding="UTF-8"?>
<?usoft-xml version="1.0" action="multi-tables-import"?><MultiImport>
<Component_Constructors documentName="Component Constructors">
<T_RDMI_COMPONENT_CONSTRUCTOR COMPONENT_NAME="OTS_MAIL" DESCRIPTION="This component uses System.Net.Mail to send an email to one or more recipients.&#13;&#10;The body can be plain text or it can contain HTML.&#13;&#10;Optionally 1 ore more attachments can be added to the mail.&#13;&#10;&#13;&#10;Example calls:&#13;&#10;&#13;&#10;INVOKE OTS_Mail.SendMail&#13;&#10;WITH&#13;&#10;SELECT 'JohnDo@MyCompany.com', 'TestMail1', 'Hello world!'&#13;&#10;&#13;&#10;&#13;&#10;INVOKE OTS_Mail.SendMailHtml&#13;&#10;WITH&#13;&#10;SELECT 'JohnDo@MyCompany.com', 'TestMail1', '&lt;u&gt;Hello&lt;u&gt;&lt;br/&gt;&lt;b&gt;world!&lt;/b&gt;'&#13;&#10;&#13;&#10;INVOKE OTS_Mail.SendMailHtml&#13;&#10;WITH&#13;&#10;SELECT 'JohnDo@MyCompany.com;JaneDo@MyCompany.com', 'TestMail1', '&lt;u&gt;Hello&lt;u&gt;&lt;br/&gt;&lt;b&gt;world!&lt;/b&gt;', 'C:\usd90setup\Doc\AddNote.pdf', 'C:\usd90setup\BITMAPS\usdlogo.bmp'" T_RDMI_AUTOMATION_SERVER="N" T_RDMI_JAVA_COMPONENT="N" T_RDMI_STATEFUL_COMPONENT="Y" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y" T_RDMI_WEB_SERVICE_COMPONENT="N" T_RDMI_DOTNET_COMPONENT="Y" T_RDMI_COMPONENT_CONSTRUCTOR="Y" CONSTRUCTOR_SQL="SELECT&#9;outgoing_mail_server, outgoing_mail_account&#10;FROM&#9;&lt;some_table&gt;" ACTIVE="Y"/>
</Component_Constructors>
<Components documentName="Components">
<T_RDMI_COMPONENT COMPONENT_NAME="OTS_MAIL" DESCRIPTION="This component uses System.Net.Mail to send an email to one or more recipients.&#13;&#10;The body can be plain text or it can contain HTML.&#13;&#10;Optionally 1 ore more attachments can be added to the mail.&#13;&#10;&#13;&#10;Example calls:&#13;&#10;&#13;&#10;INVOKE OTS_Mail.SendMail&#13;&#10;WITH&#13;&#10;SELECT 'JohnDo@MyCompany.com', 'TestMail1', 'Hello world!'&#13;&#10;&#13;&#10;&#13;&#10;INVOKE OTS_Mail.SendMailHtml&#13;&#10;WITH&#13;&#10;SELECT 'JohnDo@MyCompany.com', 'TestMail1', '&lt;u&gt;Hello&lt;u&gt;&lt;br/&gt;&lt;b&gt;world!&lt;/b&gt;'&#13;&#10;&#13;&#10;INVOKE OTS_Mail.SendMailHtml&#13;&#10;WITH&#13;&#10;SELECT 'JohnDo@MyCompany.com;JaneDo@MyCompany.com', 'TestMail1', '&lt;u&gt;Hello&lt;u&gt;&lt;br/&gt;&lt;b&gt;world!&lt;/b&gt;', 'C:\usd90setup\Doc\AddNote.pdf', 'C:\usd90setup\BITMAPS\usdlogo.bmp'" T_RDMI_AUTOMATION_SERVER="N" T_RDMI_JAVA_COMPONENT="N" T_RDMI_STATEFUL_COMPONENT="Y" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y" T_RDMI_WEB_SERVICE_COMPONENT="N" T_RDMI_DOTNET_COMPONENT="Y" T_RDMI_COMPONENT_CONSTRUCTOR="Y"/>
</Components>
<DotNet_Components documentName="DotNet Components">
<T_RDMI_DOTNET_COMPONENT COMPONENT_NAME="OTS_MAIL" DESCRIPTION="This component uses System.Net.Mail to send an email to one or more recipients.&#13;&#10;The body can be plain text or it can contain HTML.&#13;&#10;Optionally 1 ore more attachments can be added to the mail.&#13;&#10;&#13;&#10;Example calls:&#13;&#10;&#13;&#10;INVOKE OTS_Mail.SendMail&#13;&#10;WITH&#13;&#10;SELECT 'JohnDo@MyCompany.com', 'TestMail1', 'Hello world!'&#13;&#10;&#13;&#10;&#13;&#10;INVOKE OTS_Mail.SendMailHtml&#13;&#10;WITH&#13;&#10;SELECT 'JohnDo@MyCompany.com', 'TestMail1', '&lt;u&gt;Hello&lt;u&gt;&lt;br/&gt;&lt;b&gt;world!&lt;/b&gt;'&#13;&#10;&#13;&#10;INVOKE OTS_Mail.SendMailHtml&#13;&#10;WITH&#13;&#10;SELECT 'JohnDo@MyCompany.com;JaneDo@MyCompany.com', 'TestMail1', '&lt;u&gt;Hello&lt;u&gt;&lt;br/&gt;&lt;b&gt;world!&lt;/b&gt;', 'C:\usd90setup\Doc\AddNote.pdf', 'C:\usd90setup\BITMAPS\usdlogo.bmp'" T_RDMI_AUTOMATION_SERVER="N" T_RDMI_JAVA_COMPONENT="N" T_RDMI_STATEFUL_COMPONENT="Y" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y" T_RDMI_WEB_SERVICE_COMPONENT="N" T_RDMI_DOTNET_COMPONENT="Y" T_RDMI_COMPONENT_CONSTRUCTOR="Y" ASSEMBLYREFS="" PROGRAM_SOURCE="using System;&#13;&#10;using System.Net.Mail;&#13;&#10;&#13;&#10;class OTS_MAIL&#13;&#10;{&#13;&#10;&#9;private string  m_outgoing_mail_server;&#13;&#10;&#9;private string  m_outgoing_mail_account;&#13;&#10;&#13;&#10;&#9;public OTS_MAIL(string outgoing_mail_server, string outgoing_mail_account)&#13;&#10;&#9;{&#13;&#10;&#9;&#9;m_outgoing_mail_server&#9;= outgoing_mail_server;&#13;&#10;&#9;&#9;m_outgoing_mail_account&#9;= outgoing_mail_account;&#13;&#10;&#9;}&#13;&#10;&#13;&#10;&#9;private void SendMail(string recipients, string subject, string body, bool html, params object[] attachments)&#13;&#10;&#9;{&#13;&#10;&#9;&#9;MailMessage message = new MailMessage();&#13;&#10;&#9;&#9;foreach (string recipient in recipients.Split(new [] {&quot;;&quot;}, StringSplitOptions.RemoveEmptyEntries))&#13;&#10;&#9;&#9;&#9;message.To.Add(recipient);    &#13;&#10;&#9;&#9;message.Subject = subject;&#13;&#10;&#9;&#9;message.From = new System.Net.Mail.MailAddress(m_outgoing_mail_account);&#13;&#10;&#9;&#9;message.IsBodyHtml = html;&#13;&#10;&#9;&#9;message.Body = body;&#13;&#10;&#9;&#9;if( attachments != null )&#13;&#10;&#9;&#9;&#9;foreach (string attachment in attachments)&#13;&#10;&#9;&#9;&#9;&#9;message.Attachments.Add(new Attachment(attachment));&#13;&#10;&#13;&#10;&#9;&#9;SmtpClient smtp = new SmtpClient(m_outgoing_mail_server);&#13;&#10;&#9;&#9;smtp.Send(message);&#13;&#10;&#9;}&#13;&#10;&#13;&#10;&#9;public void SendMail(string recipients, string subject, string body, params object[] attachments)&#13;&#10;&#9;{&#13;&#10;&#9;&#9;SendMail(recipients, subject, body, false, attachments);&#13;&#10;&#9;}&#13;&#10;&#13;&#10;&#9;public void SendMailHtml(string recipients, string subject, string body, params object[] attachments)&#13;&#10;&#9;{&#13;&#10;&#9;&#9;SendMail(recipients, subject, body, true, attachments);&#13;&#10;&#9;}&#13;&#10;}" DOTNET_ACTIVE="Y" LANGUAGE="C#" ORIGIN="" APP_DOMAIN="Default"/>
</DotNet_Components>
<Methods documentName="Methods">
<T_RDMI_METHOD COMPONENT_NAME="OTS_MAIL" METHOD_NAME="OTS_MAIL" METHOD_SEQNO="1" PHYSICAL_METHOD_NAME="OTS_MAIL" DESCRIPTION="" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y"/>
<T_RDMI_METHOD COMPONENT_NAME="OTS_MAIL" METHOD_NAME="SENDMAIL" METHOD_SEQNO="1" PHYSICAL_METHOD_NAME="SendMail" DESCRIPTION="" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y"/>
<T_RDMI_METHOD COMPONENT_NAME="OTS_MAIL" METHOD_NAME="SENDMAILHTML" METHOD_SEQNO="1" PHYSICAL_METHOD_NAME="SendMailHtml" DESCRIPTION="" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y"/>
</Methods>
<Parameters documentName="Parameters">
<T_RDMI_PARAMETER COMPONENT_NAME="OTS_MAIL" PARAMETER_SEQNO="1" METHOD_NAME="OTS_MAIL" METHOD_SEQNO="1" PARAMETER_NAME="outgoing_mail_server" KIND="IN" PRIMITIVE_DATA_TYPE="STRING" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y"/>
<T_RDMI_PARAMETER COMPONENT_NAME="OTS_MAIL" PARAMETER_SEQNO="1" METHOD_NAME="SENDMAIL" METHOD_SEQNO="1" PARAMETER_NAME="recipients" KIND="IN" PRIMITIVE_DATA_TYPE="STRING" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y"/>
<T_RDMI_PARAMETER COMPONENT_NAME="OTS_MAIL" PARAMETER_SEQNO="1" METHOD_NAME="SENDMAILHTML" METHOD_SEQNO="1" PARAMETER_NAME="recipients" KIND="IN" PRIMITIVE_DATA_TYPE="STRING" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y"/>
<T_RDMI_PARAMETER COMPONENT_NAME="OTS_MAIL" PARAMETER_SEQNO="2" METHOD_NAME="OTS_MAIL" METHOD_SEQNO="1" PARAMETER_NAME="outgoing_mail_account" KIND="IN" PRIMITIVE_DATA_TYPE="STRING" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y"/>
<T_RDMI_PARAMETER COMPONENT_NAME="OTS_MAIL" PARAMETER_SEQNO="2" METHOD_NAME="SENDMAIL" METHOD_SEQNO="1" PARAMETER_NAME="subject" KIND="IN" PRIMITIVE_DATA_TYPE="STRING" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y"/>
<T_RDMI_PARAMETER COMPONENT_NAME="OTS_MAIL" PARAMETER_SEQNO="2" METHOD_NAME="SENDMAILHTML" METHOD_SEQNO="1" PARAMETER_NAME="subject" KIND="IN" PRIMITIVE_DATA_TYPE="STRING" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y"/>
<T_RDMI_PARAMETER COMPONENT_NAME="OTS_MAIL" PARAMETER_SEQNO="3" METHOD_NAME="SENDMAIL" METHOD_SEQNO="1" PARAMETER_NAME="body" KIND="IN" PRIMITIVE_DATA_TYPE="STRING" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y"/>
<T_RDMI_PARAMETER COMPONENT_NAME="OTS_MAIL" PARAMETER_SEQNO="3" METHOD_NAME="SENDMAILHTML" METHOD_SEQNO="1" PARAMETER_NAME="body" KIND="IN" PRIMITIVE_DATA_TYPE="STRING" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y"/>
<T_RDMI_PARAMETER COMPONENT_NAME="OTS_MAIL" PARAMETER_SEQNO="4" METHOD_NAME="SENDMAIL" METHOD_SEQNO="1" PARAMETER_NAME="attachments" KIND="INLIST" PRIMITIVE_DATA_TYPE="VARIABLE" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y"/>
<T_RDMI_PARAMETER COMPONENT_NAME="OTS_MAIL" PARAMETER_SEQNO="4" METHOD_NAME="SENDMAILHTML" METHOD_SEQNO="1" PARAMETER_NAME="attachments" KIND="INLIST" PRIMITIVE_DATA_TYPE="VARIABLE" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y"/>
</Parameters>
<Stateful_Components documentName="Stateful Components">
<T_RDMI_STATEFUL_COMPONENT COMPONENT_NAME="OTS_MAIL" DESCRIPTION="This component uses System.Net.Mail to send an email to one or more recipients.&#13;&#10;The body can be plain text or it can contain HTML.&#13;&#10;Optionally 1 ore more attachments can be added to the mail.&#13;&#10;&#13;&#10;Example calls:&#13;&#10;&#13;&#10;INVOKE OTS_Mail.SendMail&#13;&#10;WITH&#13;&#10;SELECT 'JohnDo@MyCompany.com', 'TestMail1', 'Hello world!'&#13;&#10;&#13;&#10;&#13;&#10;INVOKE OTS_Mail.SendMailHtml&#13;&#10;WITH&#13;&#10;SELECT 'JohnDo@MyCompany.com', 'TestMail1', '&lt;u&gt;Hello&lt;u&gt;&lt;br/&gt;&lt;b&gt;world!&lt;/b&gt;'&#13;&#10;&#13;&#10;INVOKE OTS_Mail.SendMailHtml&#13;&#10;WITH&#13;&#10;SELECT 'JohnDo@MyCompany.com;JaneDo@MyCompany.com', 'TestMail1', '&lt;u&gt;Hello&lt;u&gt;&lt;br/&gt;&lt;b&gt;world!&lt;/b&gt;', 'C:\usd90setup\Doc\AddNote.pdf', 'C:\usd90setup\BITMAPS\usdlogo.bmp'" T_RDMI_AUTOMATION_SERVER="N" T_RDMI_JAVA_COMPONENT="N" T_RDMI_STATEFUL_COMPONENT="Y" INTERFACE="N" MODULE="" INTERFACE_CORRECT="Y" T_RDMI_WEB_SERVICE_COMPONENT="N" T_RDMI_DOTNET_COMPONENT="Y" T_RDMI_COMPONENT_CONSTRUCTOR="Y" LIFETIME="SESSION" TRANSACTIONAL="N" SUPPORTS_COMMIT="N" SUPPORTS_ROLLBACK="N" SUPPORTS_PRECOMMIT="N" SUPPORTS_TABLECOMPONENT="N" SUPPORTS_UPDATE="N" SUPPORTS_INSERT="N" SUPPORTS_DELETE="N" SUPPORTS_CONDITIONS="N" SUPPORTS_ROWSETSIZEHINT="N"/>
</Stateful_Components>
</MultiImport>
